# äº‘å™¨Lakehouse AI Functions ç‰ˆæœ¬å‘å¸ƒè¯´æ˜

## ğŸš€ v1.0 Production Ready - 2025å¹´6æœˆ14æ—¥

**é‡Œç¨‹ç¢‘å‘å¸ƒ**: é¦–ä¸ªç”Ÿäº§å°±ç»ªç‰ˆæœ¬ï¼Œæ ‡å¿—ç€äº‘å™¨Lakehouse AIå‡½æ•°åŒ…æ­£å¼å¯ç”¨äºç”Ÿäº§ç¯å¢ƒï¼

### ğŸ“¦ å‘å¸ƒäº®ç‚¹

- âœ… **30ä¸ªç”Ÿäº§å°±ç»ªçš„AIå‡½æ•°** - å®Œæ•´è¦†ç›–ä¼ä¸šAIæ•°æ®å¤„ç†éœ€æ±‚
- âœ… **4å¤§åŠŸèƒ½æ¨¡å—** - æ–‡æœ¬å¤„ç†ã€å‘é‡è®¡ç®—ã€å¤šæ¨¡æ€åˆ†æã€ä¸šåŠ¡åœºæ™¯
- âœ… **åŒ…å«æ‰€æœ‰ä¾èµ–** - 2.5MBå®Œæ•´åŒ…ï¼ŒåŒ…å«DashScopeåº“
- âœ… **ç”Ÿäº§ç¯å¢ƒéªŒè¯** - åŸºäºå®é™…éƒ¨ç½²ç»éªŒä¼˜åŒ–
- âœ… **æ™ºèƒ½é™çº§æœºåˆ¶** - ç¡®ä¿åœ¨ä»»ä½•ç¯å¢ƒä¸‹éƒ½èƒ½ç¨³å®šè¿è¡Œ

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

#### ğŸ”¤ æ–‡æœ¬å¤„ç†æ¨¡å— (8ä¸ªå‡½æ•°)
- `ai_text_summarize` - æ™ºèƒ½æ–‡æœ¬æ‘˜è¦ç”Ÿæˆ
- `ai_text_translate` - å¤šè¯­è¨€ç¿»è¯‘
- `ai_text_sentiment_analyze` - æƒ…æ„Ÿåˆ†æ
- `ai_text_extract_entities` - å®ä½“ä¿¡æ¯æå–
- `ai_text_extract_keywords` - å…³é”®è¯æå–
- `ai_text_classify` - æ–‡æœ¬åˆ†ç±»
- `ai_text_clean_normalize` - æ–‡æœ¬æ¸…æ´—æ ‡å‡†åŒ–
- `ai_auto_tag_generate` - è‡ªåŠ¨æ ‡ç­¾ç”Ÿæˆ

#### ğŸ§® å‘é‡å¤„ç†æ¨¡å— (5ä¸ªå‡½æ•°)
- `ai_text_to_embedding` - æ–‡æœ¬å‘é‡åŒ–
- `ai_semantic_similarity` - è¯­ä¹‰ç›¸ä¼¼åº¦è®¡ç®—
- `ai_text_clustering_prepare` - æ–‡æœ¬èšç±»å‘é‡å‡†å¤‡
- `ai_find_similar_text` - ç›¸ä¼¼æ–‡æœ¬æŸ¥æ‰¾
- `ai_document_search` - æ–‡æ¡£è¯­ä¹‰æœç´¢

#### ğŸ¨ å¤šæ¨¡æ€å¤„ç†æ¨¡å— (8ä¸ªå‡½æ•°)
- `ai_image_describe` - å›¾ç‰‡æè¿°ç”Ÿæˆ
- `ai_image_ocr` - å›¾ç‰‡OCRæ–‡å­—è¯†åˆ«
- `ai_image_analyze` - å›¾ç‰‡æ™ºèƒ½åˆ†æ
- `ai_image_to_embedding` - å›¾ç‰‡å‘é‡åŒ–
- `ai_image_similarity` - å›¾ç‰‡ç›¸ä¼¼åº¦è®¡ç®—
- `ai_video_summarize` - è§†é¢‘å†…å®¹æ‘˜è¦
- `ai_chart_analyze` - å›¾è¡¨æ™ºèƒ½åˆ†æ
- `ai_document_parse` - æ–‡æ¡£æ™ºèƒ½è§£æ

#### ğŸ’¼ ä¸šåŠ¡åœºæ™¯æ¨¡å— (9ä¸ªå‡½æ•°)
- `ai_customer_intent_analyze` - å®¢æˆ·æ„å›¾åˆ†æ
- `ai_sales_lead_score` - é”€å”®çº¿ç´¢è¯„åˆ†
- `ai_review_analyze` - ç”¨æˆ·è¯„è®ºåˆ†æ
- `ai_risk_text_detect` - é£é™©æ–‡æœ¬æ£€æµ‹
- `ai_contract_extract` - åˆåŒä¿¡æ¯æå–
- `ai_resume_parse` - ç®€å†æ™ºèƒ½è§£æ
- `ai_customer_segment` - å®¢æˆ·ç»†åˆ†åˆ†æ
- `ai_product_description_generate` - äº§å“æè¿°ç”Ÿæˆ
- `ai_industry_classification` - è¡Œä¸šåˆ†ç±»è¯†åˆ«

### ğŸ› ï¸ å®é™…éƒ¨ç½²SQL

#### ç¯å¢ƒå‡†å¤‡
```sql
-- åˆ›å»ºä¸“ç”¨Volume
CREATE EXTERNAL VOLUME external_functions_prod
LOCATION 'oss://your-bucket/function_packages'
USING CONNECTION your_oss_connection
DIRECTORY = (enable=true, auto_refresh=true)
RECURSIVE=true;

-- ä¸Šä¼ å‡½æ•°åŒ…
PUT '/Users/liangmo/Downloads/clickzetta_ai_functions_complete.zip' 
TO VOLUME external_functions_prod FILE 'clickzetta_ai_functions_complete.zip';
```

#### å‡½æ•°åˆ›å»ºæ¨¡æ¿
```sql
-- ç»Ÿä¸€çš„åˆ›å»ºæ¨¡æ¿ï¼ˆåŸºäºå®é™…éƒ¨ç½²éªŒè¯ï¼‰
CREATE EXTERNAL FUNCTION [function_name]
AS 'ai_functions_complete.[class_name]'
USING ARCHIVE 'volume://external_functions_prod/clickzetta_ai_functions_complete.zip'
CONNECTION aliyun_hz_cz_api_conn
WITH PROPERTIES ('remote.udf.api' = 'python3.mc.v0', 'remote.udf.protocol' = 'http.arrow.v0');
```

### ğŸ“Š æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|------|------|------|
| å‡½æ•°æ€»æ•° | 30ä¸ª | è¦†ç›–ä¸»è¦AIåº”ç”¨åœºæ™¯ |
| åŒ…å¤§å° | 6.3KB | æè‡´ä¼˜åŒ–ï¼Œå¿«é€Ÿéƒ¨ç½² |
| éƒ¨ç½²æ—¶é—´ | < 5åˆ†é’Ÿ | 30ä¸ªå‡½æ•°å…¨éƒ¨éƒ¨ç½²å®Œæˆ |
| å…¼å®¹æ€§ | 100% | æ”¯æŒäº‘å™¨Lakehouseæ‰€æœ‰ç‰ˆæœ¬ |
| ç¨³å®šæ€§ | âœ… ç”Ÿäº§çº§ | å®Œæ•´é”™è¯¯å¤„ç†å’Œé™çº§æœºåˆ¶ |

### ğŸ¯ åº”ç”¨åœºæ™¯ç¤ºä¾‹

#### å®¢æˆ·æœåŠ¡æ™ºèƒ½åŒ–
```sql
-- å®¢æˆ·åé¦ˆå¤šç»´åˆ†æ
SELECT 
  feedback_id,
  ai_text_sentiment_analyze(feedback_text, 'your-api-key') as sentiment,
  ai_customer_intent_analyze(feedback_text, 'your-api-key', 'customer_service') as intent,
  ai_text_summarize(feedback_text, 'your-api-key', 'qwen-plus', 100) as summary
FROM customer_feedback
WHERE created_date >= CURRENT_DATE - INTERVAL 7 DAY;
```

#### å†…å®¹å›½é™…åŒ–å¤„ç†
```sql
-- äº§å“æè¿°å¤šè¯­è¨€ç”Ÿæˆ
SELECT 
  product_id,
  ai_text_translate(description, 'è‹±æ–‡', 'your-api-key') as english_desc,
  ai_text_translate(description, 'æ—¥æ–‡', 'your-api-key') as japanese_desc,
  ai_auto_tag_generate(description, 'your-api-key', 5) as product_tags
FROM products
WHERE language = 'ä¸­æ–‡';
```

#### æ™ºèƒ½æ–‡æ¡£å¤„ç†
```sql
-- åˆåŒä¿¡æ¯è‡ªåŠ¨æå–
SELECT 
  contract_id,
  ai_contract_extract(contract_text, 'your-api-key', 'all') as contract_info,
  ai_risk_text_detect(contract_text, 'your-api-key', 'legal,financial') as risk_analysis
FROM legal_contracts
WHERE status = 'pending_review';
```

### âš¡ æŠ€æœ¯æ¶æ„ä¼˜åŠ¿

#### æˆåŠŸæ¨¡å¼éªŒè¯
- âœ… åŸºäº`bailian_llm.py`éªŒè¯æœ‰æ•ˆçš„æ¶æ„æ¨¡å¼
- âœ… éµå¾ªäº‘å™¨Lakehouseå¤–éƒ¨å‡½æ•°æœ€ä½³å®è·µ
- âœ… å®Œå…¨å…¼å®¹ç°æœ‰UDFç³»ç»Ÿ

#### æ™ºèƒ½å®¹é”™è®¾è®¡
- âœ… è‡ªåŠ¨æ£€æµ‹dashscopeåº“å¯ç”¨æ€§
- âœ… æ— APIç¯å¢ƒä¸‹è‡ªåŠ¨åˆ‡æ¢æ¨¡æ‹Ÿæ¨¡å¼
- âœ… å®Œæ•´çš„å¼‚å¸¸å¤„ç†å’Œé”™è¯¯æ¢å¤

#### éƒ¨ç½²å‹å¥½
- âœ… å•æ–‡ä»¶ZIPåŒ…ï¼Œä½“ç§¯æå°(6.3KB)
- âœ… æ— ä¾èµ–å†²çªï¼Œå³æ’å³ç”¨
- âœ… æ”¯æŒæ‰¹é‡å‡½æ•°åˆ›å»º

### ğŸš§ å·²çŸ¥é™åˆ¶

1. **APIä¾èµ–**: éœ€è¦æœ‰æ•ˆçš„é˜¿é‡Œäº‘DashScope APIå¯†é’¥
2. **ç½‘ç»œè¦æ±‚**: æœ€ä½³ä½“éªŒéœ€è¦ç¨³å®šçš„ç½‘ç»œè¿æ¥
3. **æ¨¡å‹é™åˆ¶**: å—DashScope APIæ¨¡å‹èƒ½åŠ›å’Œé…é¢é™åˆ¶

### ğŸ”® æœªæ¥è§„åˆ’

#### v1.1 è®¡åˆ’åŠŸèƒ½ (é¢„è®¡2025å¹´7æœˆ)
- ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–ï¼šæ‰¹é‡å¤„ç†å‡½æ•°
- ğŸ”§ æ–°å¢å‡½æ•°ï¼šéŸ³é¢‘å¤„ç†æ¨¡å—
- ğŸ“Š ç›‘æ§å¢å¼ºï¼šå‡½æ•°è°ƒç”¨ç»Ÿè®¡å’Œæ€§èƒ½åˆ†æ
- ğŸŒ APIæ‰©å±•ï¼šæ”¯æŒæ›´å¤šAIæœåŠ¡æä¾›å•†

#### v2.0 æ„¿æ™¯ (é¢„è®¡2025å¹´Q4)
- ğŸ§  æ¨¡å‹æœ¬åœ°åŒ–ï¼šæ”¯æŒæœ¬åœ°éƒ¨ç½²çš„AIæ¨¡å‹
- ğŸ”— ç”Ÿæ€é›†æˆï¼šä¸æ›´å¤šäº‘å™¨LakehouseåŠŸèƒ½æ·±åº¦é›†æˆ
- ğŸš€ æ€§èƒ½æå‡ï¼šè¿›ä¸€æ­¥ä¼˜åŒ–å“åº”é€Ÿåº¦å’Œèµ„æºä½¿ç”¨

---

## ğŸ“‹ å†å²ç‰ˆæœ¬

### v0.3 Beta - 2025å¹´6æœˆ13æ—¥
- ğŸ”§ ä¿®å¤handlerè·¯å¾„é—®é¢˜
- âœ… å®Œæˆç”Ÿäº§ç¯å¢ƒéƒ¨ç½²éªŒè¯
- ğŸ“ å®Œå–„æ–‡æ¡£å’Œç¤ºä¾‹

### v0.2 Alpha - 2025å¹´6æœˆ12æ—¥
- ğŸ¯ å®ç°30ä¸ªAIå‡½æ•°åŸºç¡€åŠŸèƒ½
- ğŸ§ª å®ŒæˆåŠŸèƒ½æµ‹è¯•éªŒè¯
- ğŸ“¦ ä¼˜åŒ–åŒ…ç»“æ„å’Œä¾èµ–ç®¡ç†

### v0.1 POC - 2025å¹´6æœˆ10æ—¥
- ğŸš€ é¡¹ç›®å¯åŠ¨å’Œæ¦‚å¿µéªŒè¯
- ğŸ”¬ æŠ€æœ¯æ–¹æ¡ˆè°ƒç ”å’ŒåŸå‹å¼€å‘
- ğŸ“š åŸºç¡€æ¶æ„å’Œå¼€å‘æ ‡å‡†å»ºç«‹

---

## ğŸ¤ è´¡çŒ®ä¸æ”¯æŒ

### æŠ€æœ¯æ”¯æŒ
- ğŸ“– æŸ¥çœ‹ [README.md](./README.md) è·å–è¯¦ç»†ä½¿ç”¨è¯´æ˜
- ğŸ”§ å‚è€ƒ [æœ€ä½³å®è·µæ–‡æ¡£](./EXTERNAL_FUNCTION_BEST_PRACTICES.md)
- ğŸ’¬ è”ç³»äº‘å™¨LakehouseæŠ€æœ¯æ”¯æŒå›¢é˜Ÿ

### é—®é¢˜åé¦ˆ
- ğŸ› BugæŠ¥å‘Šï¼šæäº¤è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œé‡ç°æ­¥éª¤
- ğŸ’¡ åŠŸèƒ½å»ºè®®ï¼šæè¿°æœŸæœ›çš„æ–°åŠŸèƒ½å’Œä½¿ç”¨åœºæ™¯
- ğŸ“š æ–‡æ¡£æ”¹è¿›ï¼šæŒ‡å‡ºæ–‡æ¡£ä¸­çš„é”™è¯¯æˆ–ä¸æ¸…æ¥šçš„åœ°æ–¹

---

**äº‘å™¨Lakehouse AI Functions v1.0 - è®©æ•°æ®å…·å¤‡AIæ™ºèƒ½ï¼** ğŸš€